<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>å¯æ„›è–èª•æ¨¹è£é£¾</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  margin:0;
  background:#0b1d3a;
  overflow:hidden;
  font-family:system-ui,-apple-system,sans-serif;
  color:white;
}
.controls{
  position:fixed;
  left:20px;
  top:20px;
  background:rgba(20,30,50,.8);
  padding:16px;
  border-radius:16px;
  z-index:10;
  font-size:14px;
  box-shadow:0 8px 20px rgba(0,0,0,.4);
}
.controls label{display:block;margin-top:8px}
button{
  margin-top:10px;
  padding:6px 10px;
  border-radius:8px;
  border:none;
  background:#ffd86b;
  cursor:pointer;
}
canvas{display:block;}
</style>
</head>
<body>

<div class="controls">
  <strong>ğŸ„ å¯æ„›è–èª•æ¨¹</strong>
  <label>æ¨¹è‘‰ <input type="color" id="leaf" value="#1f6b45"></label>
  <label>å°çƒ <input type="color" id="ball" value="#c0392b"></label>
  <label>å½©å¸¶ <input type="color" id="ribbon" value="#d4af37"></label>
  <label>æ˜Ÿæ˜Ÿ <input type="color" id="star" value="#fff2a8"></label>
  <label>ç¦®ç‰© <input type="color" id="gift" value="#ff6fae"></label>
  <button onclick="saveImage()">ğŸ“¸ å­˜æˆåœ–ç‰‡</button>
</div>

<canvas id="c"></canvas>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

function resize(){canvas.width=innerWidth;canvas.height=innerHeight;}
resize();
addEventListener("resize",resize);

const leaf=document.getElementById("leaf");
const ballColor=document.getElementById("ball");
const ribbon=document.getElementById("ribbon");
const star=document.getElementById("star");
const giftColor=document.getElementById("gift");
const CX=()=>canvas.width/2;

let starPulse=1,dir=0.01;
const balls=[{x:-50,y:270,r:9},{x:40,y:320,r:9},{x:-10,y:360,r:9}];
const gifts=[{x:-60,y:470,w:40,h:30},{x:0,y:470,w:40,h:30},{x:60,y:470,w:40,h:30}];
const snow=Array.from({length:150},()=>({x:Math.random()*innerWidth,y:Math.random()*innerHeight,r:Math.random()*2+1,s:Math.random()*0.6+0.3}));
let dragging=null;

canvas.onmousedown=e=>{
  const mx=e.offsetX,my=e.offsetY;
  balls.forEach(b=>{if(Math.hypot(mx-(CX()+b.x),my-b.y)<b.r+5) dragging=b;});
  gifts.forEach(g=>{if(mx> CX()+g.x-g.w/2 && mx< CX()+g.x+g.w/2 && my>g.y && my<g.y+g.h) dragging=g;});
};
canvas.onmousemove=e=>{if(dragging){dragging.x=e.offsetX-CX();dragging.y=e.offsetY;}};
canvas.onmouseup=()=>dragging=null;

// å¯æ„›æ³¢æµªæ¨¹è‘‰
function leafLayer(y,w,h,color){
  ctx.fillStyle=color;
  ctx.strokeStyle="black";
  ctx.lineWidth=3;
  ctx.shadowColor="rgba(0,0,0,.4)";
  ctx.shadowBlur=8;
  ctx.beginPath();
  ctx.moveTo(CX()-w/2,y);
  for(let i=0;i<w;i+=10){
    let dx=i-w/2;
    ctx.lineTo(CX()+dx, y - Math.sin(i/10)*5 - h);
  }
  ctx.lineTo(CX()+w/2,y);
  ctx.quadraticCurveTo(CX(),y+h*0.7,CX()-w/2,y);
  ctx.fill();
  ctx.stroke();
  ctx.shadowBlur=0;
}

// ç•«è´è¶çµ
function drawBow(cx,cy,color){
  ctx.fillStyle=color;
  ctx.shadowColor="rgba(0,0,0,.3)";
  ctx.shadowBlur=4;
  ctx.beginPath(); ctx.ellipse(cx-6,cy,6,4,0,0,Math.PI*2); ctx.fill();
  ctx.beginPath(); ctx.ellipse(cx+6,cy,6,4,0,0,Math.PI*2); ctx.fill();
  ctx.beginPath(); ctx.arc(cx,cy,3,0,Math.PI*2); ctx.fill();
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // æ˜Ÿæ˜Ÿ
  starPulse+=dir; if(starPulse>1.25||starPulse<0.8)dir*=-1;
  ctx.save(); ctx.translate(CX(),140); ctx.scale(starPulse,starPulse);
  ctx.shadowColor=star.value; ctx.shadowBlur=25;
  ctx.fillStyle=star.value; ctx.beginPath();
  for(let i=0;i<5;i++){
    ctx.lineTo(Math.cos((18+i*72)*Math.PI/180)*14,-Math.sin((18+i*72)*Math.PI/180)*14);
    ctx.lineTo(Math.cos((54+i*72)*Math.PI/180)*6,-Math.sin((54+i*72)*Math.PI/180)*6);
  }
  ctx.fill(); ctx.restore();

  // æ¨¹è‘‰
  leafLayer(190,180,60,leaf.value);
  leafLayer(250,240,70,leaf.value);
  leafLayer(330,310,80,leaf.value);

  // å½©å¸¶
  ctx.strokeStyle=ribbon.value; ctx.lineWidth=4;
  [260,310,360].forEach(y=>{ctx.beginPath(); ctx.moveTo(CX()-150,y); ctx.quadraticCurveTo(CX(),y-20,CX()+150,y); ctx.stroke();});

  // å°çƒ
  balls.forEach(b=>{ctx.shadowColor="rgba(255,255,255,.7)"; ctx.shadowBlur=12; ctx.fillStyle=ballColor.value;
    ctx.beginPath(); ctx.arc(CX()+b.x,b.y,b.r,0,Math.PI*2); ctx.fill();
  });

  // æ¨¹å¹¹
  ctx.shadowBlur=0; ctx.fillStyle="#8b5a2b"; ctx.fillRect(CX()-18,390,36,90);

  // ç¦®ç‰©+è´è¶çµ
  gifts.forEach(g=>{
    ctx.shadowColor="rgba(0,0,0,.4)"; ctx.shadowBlur=6;
    ctx.fillStyle=giftColor.value; ctx.fillRect(CX()+g.x-g.w/2,g.y,g.w,g.h);
    ctx.fillStyle="rgba(255,255,255,.25)"; ctx.fillRect(CX()+g.x-g.w/2+3,g.y+3,g.w-6,6);
    drawBow(CX()+g.x,g.y-4,ribbon.value);
  });

  // é›ª
  ctx.fillStyle="white";
  snow.forEach(s=>{s.y+=s.s; if(s.y>canvas.height)s.y=0; ctx.beginPath(); ctx.arc(s.x,s.y,s.r,0,Math.PI*2); ctx.fill();});

  requestAnimationFrame(draw);
}
draw();

function saveImage(){
  const a=document.createElement("a");
  a.download="cute-christmas-tree.png";
  a.href=canvas.toDataURL();
  a.click();
}
</script>

</body>
</html>
