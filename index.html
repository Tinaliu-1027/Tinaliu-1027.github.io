<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>è£é£¾è–èª•æ¨¹</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  margin:0;
  background:#0b1d3a;
  overflow:hidden;
  font-family:system-ui,-apple-system,sans-serif;
  color:white;
}
.controls{
  position:fixed;
  left:20px;
  top:20px;
  background:rgba(20,30,50,.8);
  padding:16px;
  border-radius:16px;
  z-index:10;
  font-size:14px;
}
.controls label{display:block;margin-top:8px}
button{
  margin-top:10px;
  padding:6px 10px;
  border-radius:8px;
  border:none;
  background:#ffd86b;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="controls">
  <strong>ğŸ„ è£é£¾è–èª•æ¨¹</strong>
  <label>æ¨¹è‘‰ <input type="color" id="leaf" value="#1f6b45"></label>
  <label>å°çƒ <input type="color" id="ball" value="#c0392b"></label>
  <label>å½©å¸¶ <input type="color" id="ribbon" value="#d4af37"></label>
  <label>æ˜Ÿæ˜Ÿ <input type="color" id="star" value="#fff2a8"></label>
  <label>ç¦®ç‰© <input type="color" id="gift" value="#ff6fae"></label>
</div>

<canvas id="c"></canvas>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

function resize(){
  canvas.width = innerWidth;
  canvas.height = innerHeight;
}
resize();
addEventListener("resize", resize);

const leaf = document.getElementById("leaf");
const ballColor = document.getElementById("ball");
const ribbonColor = document.getElementById("ribbon");
const star = document.getElementById("star");
const giftColor = document.getElementById("gift");

const CX = () => canvas.width / 2;

// â­ æ˜Ÿæ˜Ÿå‹•ç•«
let starPulse = 1, dir = 0.01;

// ğŸ”´ å°çƒ
const balls = [
  { x:-40, y:270, r:9 },
  { x:30, y:320, r:9 }
];

// ğŸ€ å½©å¸¶ï¼ˆå¯ç§»å‹•ï¼‰
const ribbons = [
  { y:245, w:180 },
  { y:295, w:240 },
  { y:345, w:310 }
];

// ğŸ ç¦®ç‰©
const gifts = [
  { x:-60, y:470, w:40, h:30 },
  { x:0, y:470, w:40, h:30 },
  { x:60, y:470, w:40, h:30 }
];

let dragging = null;

// ğŸ–± æ»‘é¼ æŒ‰ä¸‹
canvas.onmousedown = e => {
  const mx = e.offsetX;
  const my = e.offsetY;
  dragging = null;

  // ğŸ”´ å°çƒ
  for(let i=balls.length-1;i>=0;i--){
    const b = balls[i];
    if(Math.hypot(mx-(CX()+b.x), my-b.y) < b.r+5){
      dragging = b;
      return;
    }
  }

  // ğŸ€ å½©å¸¶ï¼ˆåˆ¤æ–·æ˜¯å¦é»åˆ°æ›²ç·šï¼‰
  for(let r of ribbons){
    if(
      my > r.y-10 && my < r.y+10 &&
      mx > CX()-r.w/2 && mx < CX()+r.w/2
    ){
      dragging = r;
      return;
    }
  }

  // ğŸ ç¦®ç‰©
  for(let g of gifts){
    if(
      mx > CX()+g.x-g.w/2 &&
      mx < CX()+g.x+g.w/2 &&
      my > g.y && my < g.y+g.h
    ){
      dragging = g;
      return;
    }
  }

  // â• æ–°å¢å°çƒ
  const newBall = { x: mx-CX(), y: my, r:9 };
  balls.push(newBall);
  dragging = newBall;
};

// ğŸ–± æ‹–æ›³
canvas.onmousemove = e => {
  if(!dragging) return;

  if(dragging.r){ // å°çƒ
    dragging.x = e.offsetX - CX();
    dragging.y = e.offsetY;
  }else if(dragging.w){ // å½©å¸¶
    dragging.y = e.offsetY;
  }else if(dragging.h){ // ç¦®ç‰©
    dragging.x = e.offsetX - CX();
    dragging.y = e.offsetY;
  }
};

canvas.onmouseup = () => dragging = null;
canvas.onmouseleave = () => dragging = null;

// ğŸŒ² æ¨¹è‘‰
function leafLayer(y,w,h,color,blur){
  ctx.fillStyle=color;
  ctx.shadowColor="rgba(0,0,0,.4)";
  ctx.shadowBlur=blur;
  ctx.beginPath();
  ctx.moveTo(CX()-w/2,y);
  ctx.quadraticCurveTo(CX(),y-h,CX()+w/2,y);
  ctx.quadraticCurveTo(CX(),y+h*0.7,CX()-w/2,y);
  ctx.fill();
}

// ğŸ¨ è‰²éš
function shade(col,p){
  const n=parseInt(col.slice(1),16);
  return `rgb(${(n>>16)+p},${(n>>8&255)+p},${(n&255)+p})`;
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // â­ æ˜Ÿæ˜Ÿ
  starPulse+=dir;
  if(starPulse>1.25||starPulse<0.8)dir*=-1;
  ctx.save();
  ctx.translate(CX(),140);
  ctx.scale(starPulse,starPulse);
  ctx.fillStyle=star.value;
  ctx.shadowColor=star.value;
  ctx.shadowBlur=25;
  ctx.beginPath();
  for(let i=0;i<5;i++){
    ctx.lineTo(Math.cos((18+i*72)*Math.PI/180)*14,
               -Math.sin((18+i*72)*Math.PI/180)*14);
    ctx.lineTo(Math.cos((54+i*72)*Math.PI/180)*6,
               -Math.sin((54+i*72)*Math.PI/180)*6);
  }
  ctx.fill();
  ctx.restore();

  // ğŸŒ² æ¨¹
  leafLayer(190,180,60,shade(leaf.value,-30),6);
  leafLayer(250,240,70,shade(leaf.value,-10),10);
  leafLayer(330,310,80,leaf.value,14);

  // ğŸ€ å½©å¸¶ï¼ˆå¯ç§»å‹•ï¼‰
  ctx.strokeStyle = ribbonColor.value;
  ctx.lineWidth = 4;
  ribbons.forEach(r=>{
    ctx.beginPath();
    ctx.moveTo(CX()-r.w/2,r.y);
    ctx.quadraticCurveTo(CX(),r.y-20,CX()+r.w/2,r.y);
    ctx.stroke();
  });

  // ğŸ”´ å°çƒ
  balls.forEach(b=>{
    ctx.fillStyle=ballColor.value;
    ctx.shadowColor="rgba(255,255,255,.6)";
    ctx.shadowBlur=12;
    ctx.beginPath();
    ctx.arc(CX()+b.x,b.y,b.r,0,Math.PI*2);
    ctx.fill();
  });

  // ğŸªµ æ¨¹å¹¹
  ctx.shadowBlur=0;
  ctx.fillStyle="#8b5a2b";
  ctx.fillRect(CX()-18,390,36,90);

  // ğŸ ç¦®ç‰©
  gifts.forEach(g=>{
    ctx.fillStyle=giftColor.value;
    ctx.fillRect(CX()+g.x-g.w/2,g.y,g.w,g.h);
  });

  requestAnimationFrame(draw);
}
draw();
</script>

</body>
</html>
